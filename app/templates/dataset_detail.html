<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dataset: {{ filename }}</title>
    <style>
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            margin: 0;
            padding: 0;
            background: #020617;
            color: #e5e7eb;
        }
        .container {
            max-width: 1040px;
            margin: 0 auto;
            padding: 2rem 1rem 4rem;
        }
        a {
            color: #a5b4fc;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        .back-link {
            font-size: 0.9rem;
            color: #9ca3af;
        }
        h1 {
            margin: 0.2rem 0 0.5rem;
            font-size: 1.7rem;
        }
        .subtitle {
            color: #9ca3af;
            font-size: 0.9rem;
        }
        .grid {
            display: grid;
            grid-template-columns: minmax(0, 2fr) minmax(0, 3fr);
            gap: 1.5rem;
            margin-top: 1.5rem;
        }
        .full-width {
            margin-top: 1.5rem;
        }
        .card {
            background: #020617;
            border-radius: 0.75rem;
            padding: 1.3rem;
            border: 1px solid #1f2937;
            box-shadow: 0 18px 40px rgba(0,0,0,0.4);
        }
        .card h2 {
            margin-top: 0;
            font-size: 1.1rem;
        }
        .metric-row {
            font-size: 0.95rem;
            margin-bottom: 0.25rem;
        }
        .metric-label {
            color: #9ca3af;
            margin-right: 0.35rem;
        }
        pre {
            background: #020617;
            border-radius: 0.5rem;
            padding: 0.8rem;
            font-size: 0.78rem;
            overflow-x: auto;
            border: 1px solid #111827;
        }
        .tag {
            display: inline-block;
            padding: 0.15rem 0.5rem;
            border-radius: 999px;
            border: 1px solid #374151;
            font-size: 0.7rem;
            color: #9ca3af;
            margin-right: 0.25rem;
            margin-bottom: 0.25rem;
        }
        .section-title {
            font-size: 0.9rem;
            color: #9ca3af;
            margin-bottom: 0.4rem;
        }
        .ai-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            font-size: 0.8rem;
            color: #a5b4fc;
            margin-bottom: 0.3rem;
        }
        .ai-badge span.icon {
            width: 0.55rem;
            height: 0.55rem;
            border-radius: 999px;
            background: #22c55e;
            box-shadow: 0 0 8px rgba(34,197,94,0.8);
        }
    </style>
</head>
<body>
<div class="container">
    <a href="{{ url_for('main.index') }}" class="back-link">&larr; Back to home</a>
    <h1>ðŸ“Š {{ filename }}</h1>
    <div class="subtitle">
        {{ rows }} rows â€¢ {{ columns }} columns â€¢ AI-generated narrative + raw stats
    </div>

    <div class="grid">
        <div class="card">
            <h2>Dataset Overview</h2>
            <div class="metric-row">
                <span class="metric-label">Shape:</span>
                <span>{{ rows }} Ã— {{ columns }}</span>
            </div>
            <div class="metric-row section-title" style="margin-top:0.7rem;">Column Types</div>
            <div>
                {% for col, dtype in column_types.items() %}
                    <div class="metric-row">
                        <span class="metric-label">{{ col }}:</span>
                        <span>{{ dtype }}</span>
                    </div>
                {% endfor %}
            </div>

            <div class="section-title" style="margin-top:0.9rem;">Missing Values</div>
            <div>
                {% for col, count in missing.items() %}
                    <div class="metric-row">
                        <span class="metric-label">{{ col }}:</span>
                        <span>{{ count }}</span>
                    </div>
                {% endfor %}
            </div>
        </div>

        <div class="card">
            <h2>AI Insight</h2>
            <div class="ai-badge">
                <span class="icon"></span>
                <span>Powered by Gemini â€¢ Generated from Pandas analysis</span>
            </div>
            {% if ai_insight %}
                <p style="font-size:0.9rem; line-height:1.5; white-space:pre-wrap;">
                    {{ ai_insight }}
                </p>
            {% else %}
                <p style="font-size:0.9rem; color:#9ca3af;">
                    No AI insight was generated for this dataset.
                </p>
            {% endif %}
        </div>
    </div>

    <div class="card full-width">
        <h2>Preview (first 5 rows)</h2>
        <pre>{{ preview }}</pre>
    </div>

    <div class="card full-width">
        <h2>Summary Statistics</h2>
        <pre>{{ summary }}</pre>
    </div>

    <div class="card full-width">
        <h2>Correlation Matrix</h2>
        <pre>{{ correlations }}</pre>
    </div>
</div>
</body>
</html>
